<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Chana Intel PWA</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.65.1/build/stlite.css" />
    <link rel="manifest" href="./manifest.json" />
  </head>
  <body>
    <div id="root"></div>
    <script src="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.65.1/build/stlite.js"></script>
    <script>
      stlite.mount({
        requirements: ["pandas", "matplotlib"],
        entrypoint: "app.py",
        files: {
          "app.py": `
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

st.set_page_config(page_title="Chana Intelligence", layout="wide")

# --- TITLE ---
st.title("ðŸŒ¾ Chana Crop Intelligence Report")
st.caption("Reporting Date: February 22, 2026 | Frequency: Daily @ 10:30 AM")

# --- SECTION 1: NCDEX SPOT PRICES ---
st.header("ðŸ“ˆ NCDEX Spot Price Tracker (Chana)")
st.markdown("Chana prices are seeing a bullish push this morning as the market reacts to the 'Short Spring' forecasts.")

price_data = {
    "Location": ["Bikaner", "Delhi", "Akola"],
    "Today Price (â‚¹/Q)": [5575.0, 5745.6, 5400.0],
    "Y'day Price (â‚¹/Q)": [5500.0, 5702.1, 5437.5],
    "% Change": ["+1.36%", "+0.76%", "-0.69%"],
    "Market Status": ["ðŸŸ© Strong Gain", "ðŸŸ© Firming Up", "ðŸŸ¦ Softening"]
}
st.table(pd.DataFrame(price_data))

st.divider()

# --- SECTION 2: WEATHER ANALYSIS ---
st.header("ðŸŒ¡ï¸ Temperature & Weather Analysis")
st.markdown("IMD City Reports confirm a sharp rise in temperatures, tracking **3â€“5Â°C above normal**.")

col1, col2 = st.columns(2)
with col1:
    st.subheader("Bikaner (Rajasthan)")
    st.metric("Max Temp Today", "31.0Â°C", "Departure +3.0Â°C")
    st.write("**Outlook:** Max to hit 32Â°C tomorrow. Low humidity (28%) accelerating moisture loss.")

with col2:
    st.subheader("Sehore (Madhya Pradesh)")
    st.metric("Max Temp Today", "33.0Â°C", "Departure +3.0Â°C")
    st.write("**Outlook:** Terminal heat concern. Consistently breaching 32Â°C critical threshold.")

st.divider()

# --- SECTION 3: CROP FRONT ---
st.header("ðŸ§¬ Phenology & Crop Front Update")
st.info("**Stage:** Reproductive to early Grain Filling (Most sensitive period)")

c1, c2 = st.columns(2)
with c1:
    st.markdown("#### Terminal Heat Stress")
    st.write("ICAR-CRIDA warns of 'forced maturity'. Night temps >16Â°C prevent recovery, reducing seed weight by 10-12%.")
with c2:
    st.markdown("#### Forced Ripening")
    st.write("Crops in Sehore are maturing **7-10 days ahead** of schedule, potentially leading to shriveled grains.")

st.divider()

# --- SECTION 4: ADVISORY ---
st.header("ðŸ©º Agromet Advisory (Next 24-48 Hours)")
st.success("**Irrigation:** Light irrigation recommended to lower canopy temperature. Avoid over-watering.")
st.warning("**Heat Mitigation:** Foliar spray of Potassium Nitrate (1-0-45) @ 1% to help plant tolerate heat.")
st.error("**Pest Monitoring:** Inspect for Pod Borer. Spray Indoxacarb if >1 larva seen per meter row.")

st.markdown("---")
st.caption("Data Sources: NCDEX, IMD, ICAR-CRIDA, AgPulse Analytica")
          `
        }
      }, document.getElementById("root"));
    </script>
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("./sw.js");
      }
    </script>
  </body>
</html>
