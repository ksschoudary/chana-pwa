<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Chana Intel</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.65.1/build/stlite.css" />
    <style>
        html, body { font-family: 'Helvetica', sans-serif; background-color: #f8f9fa; margin: 0; padding: 0; }
        #loading-screen { 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            height: 100vh; color: #5d4037; text-align: center;
        }
    </style>
</head>
<body>
    <div id="loading-screen">
        <h2 style="font-family: Helvetica;">ðŸŒ¾ Chana Intel</h2>
        <p>Loading Dashboard... (Wait 30s)</p>
    </div>
    <div id="root"></div>
    <script src="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.65.1/build/stlite.js"></script>
    <script>
      stlite.mount({
        requirements: ["pandas"],
        entrypoint: "app.py",
        files: {
          "app.py": `
import streamlit as st
import pandas as pd
from datetime import datetime

st.set_page_config(page_title="Chana Intel", layout="wide")

# Hide loading screen & Force Helvetica
st.markdown("<style>#loading-screen {display:none;} html, body, [class*='st-'] {font-family: 'Helvetica', sans-serif !important;}</style>", unsafe_allow_html=True)

# --- HEADER ---
col_t, col_r = st.columns([4, 1])
with col_t:
    st.title("ðŸŒ¾ Chana Intelligence Report")
    st.caption(f"**Last Updated:** {datetime.now().strftime('%d %b %Y | %H:%M:%S')}")
with col_r:
    if st.button("ðŸ”„ Refresh Now"):
        st.rerun()

st.markdown("---")

# --- SECTION 1: NCDEX PRICES ---
st.subheader("ðŸ“ˆ NCDEX Spot Price Tracker (Chana)")
st.write("Prices are firming up as arrivals stabilize and terminal heat concerns grow.")

price_df = pd.DataFrame({
    "Location": ["Bikaner", "Delhi", "Akola"],
    "Today (â‚¹/Q)": [5575.0, 5745.0, 5400.0],
    "Y'day (â‚¹/Q)": [5550.0, 5741.0, 5400.0],
    "% Change": ["+0.45%", "+0.07%", "0.00%"],
    "Status": ["ðŸŸ© Gaining", "ðŸŸ© Steady", "ðŸŸ¦ Neutral"]
})
st.table(price_df)

# --- SECTION 2: WEATHER & PHENOLOGY ---
st.divider()
st.subheader("ðŸŒ¡ï¸ Weather & Crop Front")
col1, col2 = st.columns(2)

with col1:
    st.markdown("#### Bikaner (Rajasthan)")
    st.metric("Max Temp Today", "32.0Â°C", "+3.8Â°C")
    st.write("**Forecast:** Clear skies. Humidity at 24%â€”high evaporation risk.")

with col2:
    st.markdown("#### Sehore (Madhya Pradesh)")
    st.metric("Max Temp Today", "33.0Â°C", "+3.0Â°C")
    st.write("**Impact:** Night heat (>16Â°C) forcing maturity 7-10 days early.")

# --- SECTION 3: ADVISORY ---
st.divider()
st.subheader("ðŸ©º Agromet Advisory (Next 24-48 Hours)")
st.success("**Irrigation:** Apply light morning watering to mitigate heat stress.")
st.warning("**Heat Support:** Foliar spray of Potassium Nitrate (13-0-45) @ 1% to improve grain filling.")
st.error("**Pest Watch:** Monitor for Pod Borer. Spray Indoxacarb if 1-2 larvae/meter row found.")

st.caption("Data: NCDEX, IMD, ICAR-CRIDA | Report generated for Feb 23, 2026")
          `
        }
      }, document.getElementById("root"));
    </script>
</body>
</html>
